plugins {
    id 'com.r3.internal.gradle.plugins.r3Publish'
}

description "Introspiciere core"

dependencies {
    implementation project(":testing:introspiciere:introspiciere-http")
    implementation project(":testing:introspiciere:introspiciere-payloads")
    implementation project(":testing:introspiciere:introspiciere-domain")

    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlinVersion"
    implementation "info.picocli:picocli:$picocliVersion"

    integrationTestImplementation project(":testing:introspiciere:introspiciere-junit")
}

jar {
    // not sure why the dependency is not building automatically
    dependsOn ':testing:introspiciere:introspiciere-http:build'

    duplicatesStrategy = DuplicatesStrategy.EXCLUDE

    manifest {
        attributes "Main-Class": "net.corda.introspiciere.cli.MainKt"
    }

    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}